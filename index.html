<!doctype html>
<html lang="en" data-theme="system">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Bridges Park</title>

<style>
/* ======================================================
   PREMIUM MOBILE UI – COMPATIBLE WITH CURRENT app.js
   FULL COPY/PASTE (includes ALL fixes since last file)
   Fixes:
   - Theme toggle works (sun/moon + logo swap)
   - Sticky header sticks (remove overflow:hidden parent)
   - Background not cut off above header (html/body bg + overdraw)
   - More interesting premium background
   - Active row striping fixed (row capsule via tr::before)
   - Selects not clipped + fixed width
   ====================================================== */

:root{
  --bg:#070a0f;
  --text:#e5e7eb;
  --muted:#9aa3b2;

  --card:rgba(17,21,27,.78);
  --border:rgba(255,255,255,.10);

  /* Logo-friendly green */
  --accent:#9ED37A;
  --accentSoft:rgba(158,211,122,.20);
  --activeBorder:rgba(158,211,122,.95);

  --controlBg:rgba(27,34,48,.70);
  --controlBg2:rgba(27,34,48,.55);

  --scoreUnder:rgba(16,185,129,.22);
  --scoreEven:rgba(148,163,184,.20);
  --scoreOver:rgba(244,63,94,.22);

  --thead:rgba(23,28,36,.78);
  --rowBg:rgba(17,21,27,.72);
  --rowBorder:rgba(255,255,255,.10);
  --totalRow:rgba(27,35,65,.65);

  --progressTrack:rgba(255,255,255,.12);
  --progressFill:var(--accent);

  --shadow:0 16px 34px rgba(0,0,0,.28);
  --shadow2:0 10px 20px rgba(0,0,0,.22);

  --toastBg: rgba(10,12,16,0.92);
  --toastText:#fff;
}

/* Light mode overrides when html[data-theme="light"] */
html[data-theme="light"]{
  color-scheme:light;

  --bg:#f6f7fb;
  --text:#0f172a;
  --muted:#64748b;

  --card:rgba(255,255,255,.82);
  --border:rgba(15,23,42,.12);

  --accent:#8FBC6C;
  --accentSoft:rgba(143,188,108,.20);
  --activeBorder:rgba(143,188,108,.95);

  --controlBg:rgba(255,255,255,.78);
  --controlBg2:rgba(255,255,255,.62);

  --rowBg:rgba(255,255,255,.62);
  --rowBorder:rgba(15,23,42,.12);
  --totalRow:rgba(143,188,108,.18);

  --progressTrack:rgba(15,23,42,.10);

  --shadow:0 16px 34px rgba(2,6,23,.12);
  --shadow2:0 10px 20px rgba(2,6,23,.10);

  --toastBg: rgba(15,23,42,0.92);
}

html[data-theme="dark"]{ color-scheme:dark; }

html,body{ height:100%; }

/* IMPORTANT: ensures background fills safe-area region */
html, body { background: var(--bg); }

*{ box-sizing:border-box; }

/* Premium interesting background (overdraws above top to avoid cut-off) */
html::before{
  content:"";
  position:fixed;
  left:0; right:0;
  top:-60px; bottom:0; /* overdraw fixes iOS top cut */
  z-index:-1;
  background:
    radial-gradient(900px 520px at 12% -10%, rgba(158,211,122,.28), transparent 60%),
    radial-gradient(760px 520px at 92% 18%, rgba(90,130,255,.16), transparent 62%),
    radial-gradient(700px 500px at 40% 105%, rgba(244,63,94,.10), transparent 60%),
    radial-gradient(1200px 700px at 50% 40%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.22), transparent 35%, rgba(0,0,0,.20)),
    repeating-linear-gradient(135deg, rgba(255,255,255,.02) 0 2px, transparent 2px 6px),
    var(--bg);
}

body{
  margin:0;
  padding:max(14px,env(safe-area-inset-top)) 16px max(18px,env(safe-area-inset-bottom)) 16px;
  font-family:-apple-system,system-ui,sans-serif;
  color:var(--text);
  line-height:1.25;
}

.muted{ color:var(--muted); font-size:12px; }

/* Unified control style */
.control{
  border-radius:18px;
  border:1px solid var(--border);
  background:var(--controlBg);
  box-shadow:var(--shadow2);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}

/* ================= HEADER ================= */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.headerLeft{
  display:flex;
  gap:12px;
  align-items:center;
  flex:1;
  min-width:0;
}

.logoImg{
  width:56px;
  height:56px;
  object-fit:contain;
  border:none !important;
  outline:none !important;
  box-shadow:none !important;
  background:transparent;
  display:block;
  border-radius:14px;
  flex:0 0 auto;
}

.brand h1{
  margin:0;
  font-size:34px;
  font-weight:950;
  letter-spacing:-.6px;
  line-height:1.02;
}
.subtitle{
  margin-top:4px;
  color:var(--muted);
  font-size:13px;
  letter-spacing:-.1px;
}

.themeToggleBtn{
  width:52px;
  height:52px;
  padding:0;
  display:flex;
  align-items:center;
  justify-content:center;
}
.themeToggleBtn img{
  width:24px;
  height:24px;
  display:block;
}

/* ================= INFO ================= */
.infoGrid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:14px;
}
.infoCard{ padding:14px; }
.infoLabel{ margin:0; font-size:12px; color:var(--muted); }
.infoValue{ margin:6px 0 0 0; font-size:22px; font-weight:950; letter-spacing:-.3px; }

/* ================= LEGEND ================= */
.legend{
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  margin-top:12px;
  user-select:none;
}
.swatch{
  display:inline-flex;
  align-items:center;
  gap:9px;
  color:var(--muted);
  font-size:13px;
}
.dot{
  width:10px;height:10px;
  border-radius:999px;
  border:1px solid var(--border);
}
.dot-under{ background:var(--scoreUnder); }
.dot-even{ background:var(--scoreEven); }
.dot-over{ background:var(--scoreOver); }

/* ================= BUTTONS ================= */
button{
  width:100%;
  padding:16px;
  font-size:17px;
  font-weight:950;
  letter-spacing:-.2px;
  color:var(--text);
  border:1px solid var(--border);
  background:var(--controlBg);
  cursor:pointer;
  transition: transform .10s ease;
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}
button:active{ transform:scale(.985); }
button:focus{ outline:none; }

#btnGen{
  margin-top:12px;
  background:
    linear-gradient(180deg,rgba(255,255,255,.18),transparent),
    radial-gradient(1100px 160px at 50% 0%,rgba(158,211,122,.25),transparent),
    var(--controlBg);
  border-color: rgba(158,211,122,.28);
  box-shadow: var(--shadow);
}

.btnRowTwo{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:12px;
}
.btnSecondary{
  background:var(--controlBg2);
  font-size:15px;
  font-weight:900;
  padding:15px 12px;
  margin:0;
}

/* ================= NAMES ================= */
.nameBlock{
  margin-top:12px;
  padding:12px;
}
.row{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
.grow{ flex:1 1 160px; }

input[type=text]{
  width:100%;
  padding:15px 14px;
  font-size:16px;
  font-weight:850;
  letter-spacing:-.2px;
  border-radius:16px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:var(--text);
}

/* ================= SCORECARD ================= */
.card{
  margin-top:14px;
  padding:0;
  overflow:visible; /* CRITICAL: sticky works only if parents don't clip */
}

/* sticky header */
.scoreSticky{
  position:sticky;
  top:8px;
  z-index:60;
  padding:12px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  box-shadow:var(--shadow2);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
}

/* header row */
.colHeader{
  display:grid;
  grid-template-columns:10% 44% 10% 18% 18%;
  align-items:center;
  padding:12px 10px;
  background:var(--thead);
  border:1px solid var(--border);
  border-radius:18px;
  font-weight:950;
  letter-spacing:-.2px;
}

/* progress under header */
.progressWrap{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:12px;
}
.progressTrack{
  flex:1 1 auto;
  height:10px;
  border-radius:999px;
  background:var(--progressTrack);
  overflow:hidden;
  border:1px solid var(--border);
}
.progressFill{
  height:100%;
  width:0%;
  background:
    linear-gradient(90deg, rgba(255,255,255,0.18), rgba(255,255,255,0) 55%),
    var(--progressFill);
  transition: width .25s ease;
}
.progressText{
  min-width:86px;
  text-align:right;
  font-weight:900;
  color:var(--muted);
}

/* table */
table{
  width:100%;
  border-collapse:separate;
  border-spacing:0 12px;
  table-layout:fixed;
  padding:12px 0 12px; /* keep breathing room under sticky */
}

/* column lock (alignment) */
colgroup col:nth-child(1){ width:10%; }
colgroup col:nth-child(2){ width:44%; }
colgroup col:nth-child(3){ width:10%; }
colgroup col:nth-child(4){ width:18%; }
colgroup col:nth-child(5){ width:18%; }

th,td{
  padding:14px 10px;
  text-align:center;
  white-space:nowrap;
  overflow:visible; /* IMPORTANT: don't clip selects */
}

/* ===== Row capsule (fixes striping) ===== */
tbody tr.holeRow{ position:relative; }

tbody tr.holeRow::before{
  content:"";
  position:absolute;
  left:0; right:0;
  top:0; bottom:0;
  background: var(--rowBg);
  border:1px solid var(--rowBorder);
  border-radius:22px;
  box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset;
  z-index:0;
}

/* put cell content above capsule */
tbody tr.holeRow td{
  position:relative;
  z-index:1;
  background: transparent;
  border: none;
}

/* Active row highlight clean (no vertical bands) */
tbody tr.holeRow.active::before{
  background:
    linear-gradient(90deg, var(--accentSoft), rgba(255,255,255,0) 60%),
    var(--rowBg);
  border-color: rgba(158,211,122,0.25);
}

/* Strong left accent bar */
tbody tr.holeRow.active::after{
  content:"";
  position:absolute;
  left:0;
  top:0;
  bottom:0;
  width:6px;
  border-top-left-radius:22px;
  border-bottom-left-radius:22px;
  background: var(--activeBorder);
  z-index:1;
  opacity:0.95;
}

/* throw pills */
.twoPip{
  display:inline-flex;
  align-items:center;
  gap:10px;
  max-width:100%;
}
.arrow{
  font-weight:950;
  color:rgba(148,163,184,.95);
  font-size:12px;
}

.goalTag{
  position:relative;
  height:22px;
  min-width:62px;
  padding:0 12px;
  border-radius:999px;
  font-size:11px;
  font-weight:950;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border:1px solid rgba(255,255,255,.14);
  box-shadow: 0 1px 0 rgba(255,255,255,.10) inset, 0 10px 18px rgba(0,0,0,.14);
}
.goalTag::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:999px;
  background: linear-gradient(to bottom, rgba(255,255,255,0.22), rgba(255,255,255,0));
  opacity:0.35;
  pointer-events:none;
}

.goal-tee{ background:#0b0d10; color:#fff; border-color: rgba(255,255,255,.14); text-transform:lowercase; }
.goal-white{ background:#fff; color:#111; border-color: rgba(0,0,0,.10); }
.goal-blue{ background:#1f6feb; color:#fff; }
.goal-orange{ background:#ff8a00; color:#111; border-color: rgba(0,0,0,.10); }
.goal-pink{ background:#ff5aa5; color:#111; border-color: rgba(0,0,0,.10); }
.goal-red{ background:#e11d48; color:#fff; }
.goal-green{ background:#16a34a; color:#fff; }
.goal-yellow{ background:#ffd400; color:#111; border-color: rgba(0,0,0,.10); }

/* score selects (fixed width looks better + avoids clipping) */
select{
  width:72px;
  max-width:72px;
  padding:10px;
  border-radius:16px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:var(--text);
  font-weight:950;
}

/* score color classes (app.js sets these) */
.score-under{ background:var(--scoreUnder); }
.score-even{ background:var(--scoreEven); }
.score-over{ background:var(--scoreOver); }

/* summary cells (app.js expects these ids) */
.sumCell{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:5px;
  line-height:1.05;
}
.sumDiff{
  font-size:18px;
  font-weight:950;
  padding:4px 12px;
  border-radius:999px;
  border:1px solid var(--border);
  min-width:46px;
}
.sumThrows{
  font-size:11px;
  color:var(--muted);
  font-weight:900;
}

.left{ text-align:left; }

/* total row tint */
tfoot tr.totalRow th,
tfoot tr.totalRow td{
  background:var(--totalRow);
  border-top:1px solid var(--rowBorder);
  border-bottom:1px solid var(--rowBorder);
  border-radius:0; /* keep clean */
}

/* toast */
.toast{
  position:fixed;
  left:50%;
  bottom:18px;
  transform:translateX(-50%);
  background:var(--toastBg);
  color:var(--toastText);
  padding:10px 14px;
  border-radius:14px;
  opacity:0;
  pointer-events:none;
  transition: opacity .18s ease, transform .18s ease;
  z-index:9999;
  box-shadow: 0 14px 24px rgba(0,0,0,.25);
}
.toast.show{
  opacity:1;
  transform:translateX(-50%) translateY(-2px);
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <div class="headerLeft">
    <img id="logoLight" class="logoImg" src="C542D141-EA75-4C1C-9345-50C8E08D9EE5.png" alt="Bridges Park logo">
    <img id="logoDark" class="logoImg" src="B19327BB-FD35-4A0C-8F34-56CC91793687.png" alt="Bridges Park logo (dark)" style="display:none;">
    <div class="brand">
      <h1>Bridges Park</h1>
      <div class="subtitle">Disc Golf • Course Generator + Scorecard</div>
    </div>
  </div>

  <button id="themeToggle" class="themeToggleBtn control" type="button" aria-label="Toggle theme">
    <img id="themeIcon" src="moon.png" alt="Theme icon">
  </button>
</div>

<!-- INFO -->
<div class="infoGrid">
  <div class="infoCard control">
    <div class="infoLabel">Holes</div>
    <div class="infoValue">18</div>
  </div>
  <div class="infoCard control">
    <div class="infoLabel">Par (Front / Back / Total)</div>
    <div class="infoValue">
      <span id="parFrontTop">–</span> /
      <span id="parBackTop">–</span> /
      <span id="parTotalTop">–</span>
    </div>
  </div>
</div>

<!-- LEGEND (outside scorecard) -->
<div class="legend">
  <div class="swatch"><span class="dot dot-under"></span> Under</div>
  <div class="swatch"><span class="dot dot-even"></span> Even</div>
  <div class="swatch"><span class="dot dot-over"></span> Over</div>
</div>

<!-- BUTTONS -->
<button id="btnGen" class="control" type="button">Generate New Course</button>

<div class="btnRowTwo">
  <button id="btnClear" class="btnSecondary control" type="button">Clear Scores</button>
  <button id="btnCopyLink" class="btnSecondary control" type="button">Copy Share Link</button>
</div>

<!-- NAMES -->
<div class="nameBlock control">
  <div class="row">
    <div class="grow"><input id="n1" type="text" placeholder="Player 1 name"></div>
    <div class="grow"><input id="n2" type="text" placeholder="Player 2 name"></div>
  </div>
</div>

<!-- SCORECARD -->
<div class="card">
  <div class="scoreSticky">
    <div class="colHeader" aria-hidden="true">
      <div>#</div>
      <div>Throw</div>
      <div>Par</div>
      <div id="p1HeadSticky">P1</div>
      <div id="p2HeadSticky">P2</div>
    </div>

    <div class="progressWrap">
      <div class="progressTrack"><div id="progressFill" class="progressFill"></div></div>
      <div id="progressText" class="progressText">0 / 18</div>
    </div>
  </div>

  <table>
    <colgroup><col><col><col><col><col></colgroup>
    <thead style="display:none;">
      <tr><th>#</th><th>Throw</th><th>Par</th><th>P1</th><th>P2</th></tr>
    </thead>

    <tbody id="mainBody"></tbody>

    <tfoot>
      <tr id="backRow">
        <th colspan="2" class="left">Back 9</th>
        <th id="parBackCell">–</th>
        <th>
          <div class="sumCell">
            <span id="bd1" class="sumDiff">0</span>
            <span id="b1" class="sumThrows">0</span>
          </div>
        </th>
        <th>
          <div class="sumCell">
            <span id="bd2" class="sumDiff">0</span>
            <span id="b2" class="sumThrows">0</span>
          </div>
        </th>
      </tr>

      <tr class="totalRow">
        <th colspan="2" class="left">Total</th>
        <th id="parTotalCell">–</th>
        <th>
          <div class="sumCell">
            <span id="d1" class="sumDiff">0</span>
            <span id="t1" class="sumThrows">0</span>
          </div>
        </th>
        <th>
          <div class="sumCell">
            <span id="d2" class="sumDiff">0</span>
            <span id="t2" class="sumThrows">0</span>
          </div>
        </th>
      </tr>
    </tfoot>
  </table>
</div>

<div id="toast" class="toast">Saved</div>

<!-- THEME TOGGLE (capture + stop conflicts) -->
<script>
(function(){
  const root = document.documentElement;
  const btn  = document.getElementById("themeToggle");
  const icon = document.getElementById("themeIcon");
  const logoLight = document.getElementById("logoLight");
  const logoDark  = document.getElementById("logoDark");

  function prefersDark(){
    return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  }
  function getSaved(){
    const t = localStorage.getItem("bp_theme");
    return (t === "dark" || t === "light") ? t : null;
  }
  function apply(theme){
    root.setAttribute("data-theme", theme);
    const isDark = theme === "dark";
    if (icon) icon.src = isDark ? "sun.png" : "moon.png"; // shows what you'll switch TO
    if (logoLight && logoDark){
      logoLight.style.display = isDark ? "none" : "block";
      logoDark.style.display  = isDark ? "block" : "none";
    }
  }

  // init
  apply(getSaved() || (prefersDark() ? "dark" : "light"));

  // follow system if user hasn't chosen
  if (window.matchMedia){
    const mq = window.matchMedia("(prefers-color-scheme: dark)");
    const handler = () => { if (!getSaved()) apply(prefersDark() ? "dark" : "light"); };
    if (mq.addEventListener) mq.addEventListener("change", handler);
    else if (mq.addListener) mq.addListener(handler);
  }

  // capture click early + stop conflicts
  if (btn){
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      if (e.stopImmediatePropagation) e.stopImmediatePropagation();

      const current = root.getAttribute("data-theme") || (prefersDark() ? "dark" : "light");
      const next = current === "dark" ? "light" : "dark";
      localStorage.setItem("bp_theme", next);
      apply(next);
    }, true);
  }
})();
</script>

<!-- iOS cache buster -->
<script src="app.js?v=7"></script>
</body>
</html>
